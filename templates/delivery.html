{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙˆØµÙŠÙ„ - Ø¨ØªÙ„Ø© ÙÙ„Ø§ÙˆØ±Ø²</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background-color: #fff;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .section-box {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      box-shadow: 0 0 10px rgba(100, 0, 200, 0.07);
    }
    h2, h3 {
      color: #e91e63;
      margin-bottom: 15px;
    }
    select, textarea, input[type="date"], input[type="time"] {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }
    button {
      background-color: #e91e63;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background-color: #e91e63;
    }
    iframe {
      width: 100%;
      height: 300px;
      border-radius: 10px;
      border: none;
    }
    .stars {
      font-size: 22px;
      color: gold;
    }
    .message {
      margin-top: 10px;
      font-weight: bold;
      color: #4caf50;
    }
    .rating {
  direction: rtl;
  unicode-bidi: bidi-override;
  display: inline-block;
}

.rating input {
  display: none;
}

.rating label {
  font-size: 26px;
  color: #ccc;
  cursor: pointer;
  transition: color 0.2s;
}

.rating input:checked ~ label {
  color: gold;
}

.rating label:hover,
.rating label:hover ~ label {
  color: gold;
}

  </style>
</head>
<body>

{% include "partials/header.html" %}

<div class="container">

  <!-- âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© -->
  <div class="section-box">
    <h3>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„ØªÙŠ Ù†ÙˆØµÙ„ Ø¥Ù„ÙŠÙ‡Ø§:</h3>
    <select id="city-select" onchange="updateDeliveryInfo()">
      <option value="" selected disabled>Ø§Ø®ØªØ± Ù…Ø¯ÙŠÙ†Ø©...</option>
      <option value="Ø§Ù„Ø±ÙŠØ§Ø¶">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
      <option value="Ø¬Ø¯Ø©">Ø¬Ø¯Ø©</option>
      <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
      <option value="Ù…ÙƒØ©">Ù…ÙƒØ©</option>
      <option value="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
    </select>
    <div id="delivery-info" class="message"></div>
  </div>

  <!-- âœ… Ø§Ù„Ø®Ø±ÙŠØ·Ø© ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
  <div class="section-box">
    <h3>Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©:</h3>
    <button onclick="locateMe()">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ</button>
    <iframe id="user-map"
      src="https://maps.google.com/maps?q=24.7136,46.6753&hl=ar&z=14&output=embed"
      allowfullscreen loading="lazy">
    </iframe>
    <div id="nearest-branch" class="message"></div>
  </div>

  <!-- âœ… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ¬Ø±Ø¨Ø© -->
  <div class="section-box">
  <h3>Ù‚ÙŠÙ‘Ù… ØªØ¬Ø±Ø¨ØªÙƒ:</h3>
  <div class="rating">
    <input type="radio" id="star5" name="rating" value="5"><label for="star5">â˜…</label>
    <input type="radio" id="star4" name="rating" value="4"><label for="star4">â˜…</label>
    <input type="radio" id="star3" name="rating" value="3"><label for="star3">â˜…</label>
    <input type="radio" id="star2" name="rating" value="2"><label for="star2">â˜…</label>
    <input type="radio" id="star1" name="rating" value="1"><label for="star1">â˜…</label>
  </div>
  <textarea placeholder="Ø§ØªØ±Ùƒ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§..."></textarea>
</div>

  <!-- âœ… Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„ -->
  <div class="section-box">
    <h3>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„:</h3>
    <ul>
      <li>Ø§Ù„Ø±ÙŠØ§Ø¶: 9 ØµØ¨Ø§Ø­Ù‹Ø§ - 11 Ù…Ø³Ø§Ø¡Ù‹</li>
      <li>Ø¬Ø¯Ø©: 10 ØµØ¨Ø§Ø­Ù‹Ø§ - 10 Ù…Ø³Ø§Ø¡Ù‹</li>
      <li>Ø§Ù„Ø´Ø±Ù‚ÙŠØ©: 9 ØµØ¨Ø§Ø­Ù‹Ø§ - 9 Ù…Ø³Ø§Ø¡Ù‹</li>
    </ul>
  </div>

  <!-- âœ… Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ ØªÙˆØµÙŠÙ„ -->
  <div class="section-box">
    <h3>Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ ØªÙˆØµÙŠÙ„:</h3>
    <input type="date" />
    <input type="time" />
  </div>

  <!-- âœ… ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø·Ù„Ø¨ -->
  <div class="section-box" style="text-align: center;">
    <button onclick="checkOrderStatus()">âœ… ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø·Ù„Ø¨</button>
  </div>

</div>

{% include "partials/footer.html" %}

<script>
  function updateDeliveryInfo() {
    const city = document.getElementById("city-select").value;
    const info = document.getElementById("delivery-info");
    const supported = ["Ø§Ù„Ø±ÙŠØ§Ø¶", "Ø¬Ø¯Ø©", "Ø§Ù„Ø´Ø±Ù‚ÙŠØ©"];

    if (supported.includes(city)) {
      info.textContent = `âœ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…ØªØ§Ø­ ÙÙŠ ${city} Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹ØªÙŠÙ†.`;
    } else {
      info.textContent = `âŒ Ù†Ø£Ø³ÙØŒ Ù„Ø§ Ù†ÙˆÙØ± Ø§Ù„ØªÙˆØµÙŠÙ„ Ø­Ø§Ù„ÙŠÙ‹Ø§ ÙÙŠ ${city}.`;
    }
  }

  function locateMe() {
    const map = document.getElementById("user-map");
    const branch = document.getElementById("nearest-branch");

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(position => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        map.src = `https://maps.google.com/maps?q=${lat},${lon}&hl=ar&z=14&output=embed`;

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø£Ù‚Ø±Ø¨
        if (lat >= 24 && lat <= 25 && lon >= 46 && lon <= 47) {
          branch.textContent = "Ø£Ù‚Ø±Ø¨ ÙØ±Ø¹ Ø¥Ù„ÙŠÙƒ: ÙØ±Ø¹ Ø§Ù„Ø¹Ù„ÙŠØ§ - Ø§Ù„Ø±ÙŠØ§Ø¶.";
        } else {
          branch.textContent = "ğŸ“ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† ØªØ­Ø¯ÙŠØ¯ ÙØ±Ø¹ Ù‚Ø±ÙŠØ¨.";
        }
      }, () => {
        alert("Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹Ùƒ.");
      });
    } else {
      alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹.");
    }
  }

  function checkOrderStatus() {
    fetch("{% url 'check_order_status' %}", {
      headers: { 'X-Requested-With': 'XMLHttpRequest' }
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === "confirmed") {
        alert("âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§.");
      } else {
        alert("ğŸš« Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ©. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹.");
      }
    });
  }
</script>

</body>
</html>
