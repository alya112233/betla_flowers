{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>إتمام الشراء - بتلة فلاورز</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="إتمام عملية الشراء بأمان وسرعة من بتلة فلاورز">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  
  </head>
<body>
   {% include "partials/header.html" %}
  <style>
    /* اتركي هذا القسم لإضافة CSS بنفسك */
    
/* أنماط صفحة الدفع */
.checkout-page {
    padding: 40px 0;
    background-color: #f9f9f9;
    min-height: 70vh;
}

.checkout-header {
    margin-bottom: 30px;
    text-align: center;
}

.checkout-header h1 {
    font-size: 32px;
    color: #333;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.checkout-header h1 i {
    color: #e83e8c;
}

.breadcrumb {
    color: #777;
    font-size: 14px;
}

.breadcrumb a {
    color: #e83e8c;
    text-decoration: none;
}

.checkout-steps {
    display: flex;
    justify-content: space-between;
    margin-bottom: 40px;
    position: relative;
}

.checkout-steps::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 0;
    right: 0;
    height: 2px;
    background-color: #eee;
    z-index: 1;
}

.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 2;
    flex: 1;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #eee;
    color: #777;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-bottom: 10px;
    border: 3px solid white;
}

.step-title {
    font-size: 14px;
    color: #777;
    text-align: center;
}

.step.active .step-number {
    background-color: #e83e8c;
    color: white;
}

.step.active .step-title {
    color: #333;
    font-weight: 500;
}

.checkout-form {
    background: white;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    padding: 30px;
}

.form-step {
    display: none;
}

.form-step.active {
    display: block;
}

.form-step h2 {
    font-size: 24px;
    margin-bottom: 25px;
    color: #333;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

.form-row {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}

.form-row .form-group {
    flex: 1;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #555;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 15px;
    transition: border-color 0.3s;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    border-color: #e83e8c;
    outline: none;
}

.form-group textarea {
    min-height: 100px;
    resize: vertical;
}

.payment-methods {
    margin-bottom: 30px;
}

.payment-method {
    margin-bottom: 15px;
}

.payment-method input[type="radio"] {
    display: none;
}

.payment-method label {
    display: flex;
    align-items: center;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}

.payment-method label i {
    font-size: 24px;
    margin-left: 10px;
    color: #555;
}

.payment-method label span {
    font-weight: 500;
}

.payment-method input[type="radio"]:checked + label {
    border-color: #e83e8c;
    background-color: #fce4ec;
}

.payment-details {
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 5px;
    margin-top: 15px;
    display: none;
}

.payment-method input[type="radio"]:checked ~ .payment-details {
    display: block;
}

.order-summary {
    background-color: #f9f9f9;
    border-radius: 5px;
    padding: 20px;
    margin-bottom: 30px;
}

.summary-section {
    margin-bottom: 25px;
}

.summary-section h3 {
    font-size: 18px;
    margin-bottom: 15px;
    color: #333;
    padding-bottom: 10px;
    border-bottom: 1px dashed #ddd;
}

.order-items {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.order-item {
    display: flex;
    justify-content: space-between;
}

.order-item.total {
    font-weight: bold;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px dashed #ddd;
}

.item-price {
    color: #e83e8c;
}

.terms {
    display: flex;
    align-items: center;
    margin-bottom: 30px;
}

.terms input {
    width: auto;
    margin-left: 10px;
}

.terms label {
    margin-bottom: 0;
}

.terms a {
    color: #e83e8c;
    text-decoration: none;
}

.terms a:hover {
    text-decoration: underline;
}

.form-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 30px;
}

.btn {
    padding: 12px 25px;
    background-color: #e83e8c;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
}

.btn:hover {
    background-color: #d42d7b;
}

.prev-step {
    background-color: #f5f5f5;
    color: #333;
}

.prev-step:hover {
    background-color: #eee;
}

/* ✅ تصميم متجاوب */
@media (max-width: 768px) {
    .checkout-steps {
        display: flex;
        flex-wrap: nowrap;     /* يمنع النزول لسطر جديد */
        justify-content: center;
        gap: 10px;             /* مسافة بين الأرقام */
    }

    .step {
        flex: 0 0 40px;        /* عرض ثابت */
        height: 40px;
        border-radius: 50%;
        background-color: #f3f3f3;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #e83e8c;
    }

    .form-row {
        flex-direction: column;
        gap: 15px;
    }

    .form-actions {
        flex-direction: column-reverse;
        gap: 15px;
    }

    .btn {
        width: 100%;
    }
}

@media (max-width: 576px) {
    .checkout-header h1 {
        font-size: 24px;
    }

    .checkout-steps {
        gap: 8px;
    }

    .step {
        width: 36px;
        height: 36px;
        font-size: 14px;
    }

    .step-title {
        font-size: 12px;
    }
}
  
  </style>

           <main class="checkout-page">
  <div class="container">
    <div class="checkout-header">
      <h1><i class="fas fa-credit-card"></i> إتمام عملية الشراء</h1>
      <div class="breadcrumb">
        <a href="{% url 'home' %}">الرئيسية</a> /
        <a href="{% url 'cart' %}">سلة التسوق</a> /
        <span>إتمام الشراء</span>
      </div>
    </div>

    <form method="post" id="checkoutForm">
      {% csrf_token %}
      
      <!-- خطوات التنقل -->
      <div class="checkout-steps">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <div class="step-title">معلومات العميل</div>
        </div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <div class="step-title">عنوان الشحن</div>
        </div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <div class="step-title">طريقة الدفع</div>
        </div>
        <div class="step" data-step="4">
          <div class="step-number">4</div>
          <div class="step-title">تأكيد الطلب</div>
        </div>
      </div>
            <form class="checkout-form" id="checkoutForm">
                <!-- الخطوة 1: معلومات العميل -->
                <div class="form-step active" id="step-1">
                    <h2>معلومات العميل</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">الاسم الأول *</label>
                            <input type="text" id="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">اسم العائلة *</label>
                            <input type="text" id="lastName" required>
                        </div>
                    </div>
                    
                    <div class="form-group">


<label for="email">البريد الإلكتروني *</label>
                        <input type="email" id="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">رقم الجوال *</label>
                        <input type="tel" id="phone" required>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn next-step">التالي</button>
                    </div>
                </div>

                <!-- الخطوة 2: عنوان الشحن -->
                <div class="form-step" id="step-2">
                    <h2>عنوان الشحن</h2>
                    
                    <div class="form-group">
                        <label for="country">الدولة *</label>
                        <select id="country" required>
                            <option value="">اختر الدولة</option>
                            <option value="SA" selected>المملكة العربية السعودية</option>
                            <option value="AE">الإمارات العربية المتحدة</option>
                            <option value="KW">الكويت</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="city">المدينة *</label>
                        <select id="city" required>
                            <option value="">اختر المدينة</option>
                            <option value="Riyadh">الرياض</option>
                            <option value="Jeddah">جدة</option>
                            <option value="Dammam">الدمام</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="address">العنوان التفصيلي *</label>
                        <textarea id="address" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="postalCode">الرمز البريدي</label>
                        <input type="text" id="postalCode">
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn prev-step">السابق</button>
                        <button type="button" class="btn next-step">التالي</button>
                    </div>
                </div>

                <!-- الخطوة 3: طريقة الدفع -->
                <div class="form-step" id="step-3">
                    <h2>طريقة الدفع</h2>
                    
                    <div class="payment-methods">
                        <div class="payment-method">
                            <input type="radio" name="paymentMethod" id="creditCard" value="creditCard" checked>
                            <label for="creditCard">
                                <i class="fab fa-cc-visa"></i>
                                <i class="fab fa-cc-mastercard"></i>
                                <span>بطاقة ائتمان / مدى</span>
                            </label>
                            
                            <div class="payment-details">
                                <div class="form-group">
                                    <label for="cardNumber">رقم البطاقة *</label>
                                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" required>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="cardExpiry">تاريخ الانتهاء *</label>
                                        <input type="text" id="cardExpiry" placeholder="MM/YY" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="cardCvv">CVV *</label>


<input type="text" id="cardCvv" placeholder="123" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="payment-method">
                            <input type="radio" name="paymentMethod" id="mada" value="mada">
                            <label for="mada">
                                <i class="fas fa-credit-card"></i>
                                <span>مدى</span>
                            </label>
                        </div>
                        
                        <div class="payment-method">
                            <input type="radio" name="paymentMethod" id="applePay" value="applePay">
                            <label for="applePay">
                                <i class="fab fa-apple-pay"></i>
                                <span>Apple Pay</span>
                            </label>
                        </div>
                        
                        <div class="payment-method">
                            <input type="radio" name="paymentMethod" id="cashOnDelivery" value="cashOnDelivery">
                            <label for="cashOnDelivery">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>الدفع عند الاستلام</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn prev-step">السابق</button>
                        <button type="button" class="btn next-step">التالي</button>
                    </div>
                </div>

                <!-- الخطوة 4: تأكيد الطلب -->
                <div class="form-step" id="step-4">
                    <h2>تأكيد الطلب</h2>
                    
                    <div class="order-summary">
                        <div class="summary-section">
                            <h3>معلومات العميل</h3>
                            <p id="confirm-name"> </p>
                            <p id="confirm-email"></p>
                            <p id="confirm-phone"></p>
                        </div>
                        
                        <div class="summary-section">
                            <h3>عنوان الشحن</h3>
                            <p id="confirm-address">الرياض، حي الصحافة، شارع الملك فهد</p>
                        </div>
                        
                        <div class="summary-section">
                            <h3>طريقة الدفع</h3>
                            <p id="confirm-payment">بطاقة ائتمان / مدى</p>
                        </div>
                        
                        <div class="summary-section">
                            <h3>ملخص الطلب</h3>
                            <div class="order-items">
                                <div class="order-item">
                                    <span class="item-name">باقة ورد طبيعي × 1</span>
                                    <span class="item-price">149 ر.س</span>
                                </div>
                                <div class="order-item">
                                    <span class="item-name">هدية عيد ميلاد × 2</span>
                                    <span class="item-price">398 ر.س</span>
                                </div>
                                <div class="order-item">
                                    <span class="item-name">الشحن</span>
                                    <span class="item-price">25 ر.س</span>
                                </div>
                                <div class="order-item total">
                                    <span class="item-name">المجموع النهائي</span>
                                    <span class="item-price">572 ر.س</span>
                                </div>


</div>
                        </div>
                    </div>
                    
                    <div class="form-group terms">
                        <input type="checkbox" id="agreeTerms" required>
                        <label for="agreeTerms">أوافق على <a href="#">الشروط والأحكام</a> وسياسة الخصوصية</label>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn prev-step">السابق</button>
                        <button type="submit" class="btn submit-order">تأكيد الطلب</button>
                    </div>
                </div>
            </form>
        </div>
    </main>
    
   <script>
document.addEventListener('DOMContentLoaded', function () {
  const steps = document.querySelectorAll('.form-step');
  const stepIndicators = document.querySelectorAll('.step');
  const nextBtns = document.querySelectorAll('.next-step');
  const prevBtns = document.querySelectorAll('.prev-step');
  const form = document.getElementById('checkoutForm');
  let currentStep = 0;

  function showStep(index) {
    steps.forEach((step, i) => {
      step.classList.toggle('active', i === index);
    });

    stepIndicators.forEach((indicator, i) => {
      if (i <= index) {
        indicator.classList.add('active');
      } else {
        indicator.classList.remove('active');
      }
    });

    currentStep = index;
  }

  function validateStep(index) {
    const inputs = steps[index].querySelectorAll('input, select, textarea');
    for (let input of inputs) {
      if (input.hasAttribute('required') && !input.value.trim()) {
        return false;
      }
    }
    return true;
  }

  nextBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      if (validateStep(currentStep)) {
        showStep(currentStep + 1);
      } else {
        alert('الرجاء إكمال جميع الحقول المطلوبة بشكل صحيح');
      }
    });
  });

  prevBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      showStep(currentStep - 1);
    });
  });

  form.addEventListener('submit', function (e) {
    e.preventDefault();
    if (!validateStep(currentStep)) {
      alert('يرجى إكمال البيانات المطلوبة قبل تأكيد الطلب');
      return;
    }

    alert('تم استلام طلبك بنجاح! سيتم التواصل معك لتأكيد التفاصيل.');

    // توجيه المستخدم لصفحة "petals"
    window.location.href = "{% url 'petals' %}";
  });

  // عرض الخطوة الأولى افتراضيًا
  showStep(currentStep);
});
</script>



    {% include 'partials/footer.html' %}
</body>
</html>
